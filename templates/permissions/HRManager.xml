<?xml version="1.0" encoding="UTF-8"?>
<PermissionTemplate xmlns="http://hrm.system/permissions">
  <Metadata>
    <Name>HRManager</Name>
    <DisplayName>Quản lý nhân sự</DisplayName>
    <Description>Template dành cho HR Manager với quyền quản lý đầy đủ nhân sự trong phạm vi công ty hoặc phòng ban</Description>
    <Version>1.0</Version>
    <ApplicableTo>User</ApplicableTo>
    <Category>Management</Category>
    <IsSystem>true</IsSystem>
  </Metadata>

  <Permissions>
    <!-- Personnel Module -->
    <Module name="Personnel" displayName="Quản lý nhân sự">

      <!-- Employee Entity -->
      <Entity name="Employee" displayName="Nhân viên">

        <!-- View employees with full information -->
        <Action name="View" displayName="Xem thông tin nhân viên" defaultScope="Department">
          <Scopes>
            <Scope value="Company" displayName="Toàn công ty" />
            <Scope value="Department" displayName="Cùng phòng ban" />
            <Scope value="Position" displayName="Cùng chức danh" readOnly="true" />
            <Scope value="Self" displayName="Chỉ bản thân" />
          </Scopes>
          <!-- HR can view all fields including salary -->
        </Action>

        <!-- Create new employee -->
        <Action name="Create" displayName="Tạo nhân viên mới">
          <Scopes>
            <Scope value="Company" displayName="Tạo ở bất kỳ phòng ban" />
            <Scope value="Department" displayName="Tạo trong phòng ban mình" />
          </Scopes>
        </Action>

        <!-- Update employee information -->
        <Action name="Update" displayName="Cập nhật thông tin nhân viên" defaultScope="Department">
          <Scopes>
            <Scope value="Company" displayName="Toàn công ty" />
            <Scope value="Department" displayName="Cùng phòng ban" />
            <Scope value="Self" displayName="Chỉ bản thân" />
          </Scopes>
          <!-- HR can update all fields including salary -->
        </Action>

        <!-- Delete/Terminate employee -->
        <Action name="Delete" displayName="Xóa/Nghỉ việc nhân viên">
          <Scopes>
            <Scope value="Company" displayName="Toàn công ty" />
            <Scope value="Department" displayName="Cùng phòng ban" />
          </Scopes>
          <Constraints>
            <Constraint type="WorkflowState">
              <Parameters>
                <!-- Cannot delete terminated employees (use Archive instead) -->
                <Parameter name="AllowedStates" value="Active,Probation,OnLeave" />
              </Parameters>
            </Constraint>
          </Constraints>
        </Action>

        <!-- Export employee data -->
        <Action name="Export" displayName="Xuất dữ liệu nhân viên">
          <Scopes>
            <Scope value="Company" displayName="Toàn công ty" />
            <Scope value="Department" displayName="Cùng phòng ban" />
          </Scopes>
        </Action>

      </Entity>

      <!-- Department Entity -->
      <Entity name="Department" displayName="Phòng ban">
        <Action name="View" displayName="Xem phòng ban">
          <Scopes>
            <Scope value="Company" displayName="Toàn công ty" />
            <Scope value="Department" displayName="Phòng ban mình" />
          </Scopes>
        </Action>

        <Action name="Create" displayName="Tạo phòng ban">
          <Scopes>
            <Scope value="Company" displayName="Toàn công ty" />
          </Scopes>
        </Action>

        <Action name="Update" displayName="Cập nhật phòng ban">
          <Scopes>
            <Scope value="Company" displayName="Toàn công ty" />
            <Scope value="Department" displayName="Phòng ban mình" />
          </Scopes>
        </Action>

        <Action name="Delete" displayName="Xóa phòng ban">
          <Scopes>
            <Scope value="Company" displayName="Toàn công ty" />
          </Scopes>
        </Action>
      </Entity>

      <!-- Position Entity -->
      <Entity name="Position" displayName="Chức danh">
        <Action name="View" displayName="Xem chức danh">
          <Scopes>
            <Scope value="Company" displayName="Toàn công ty" />
            <Scope value="Department" displayName="Cùng phòng ban" />
          </Scopes>
        </Action>

        <Action name="Create" displayName="Tạo chức danh">
          <Scopes>
            <Scope value="Company" displayName="Toàn công ty" />
          </Scopes>
        </Action>

        <Action name="Update" displayName="Cập nhật chức danh">
          <Scopes>
            <Scope value="Company" displayName="Toàn công ty" />
          </Scopes>
        </Action>

        <Action name="Delete" displayName="Xóa chức danh">
          <Scopes>
            <Scope value="Company" displayName="Toàn công ty" />
          </Scopes>
        </Action>
      </Entity>

    </Module>

    <!-- Attendance Module -->
    <Module name="Attendance" displayName="Chấm công">

      <Entity name="Timesheet" displayName="Bảng chấm công">
        <!-- View timesheets -->
        <Action name="View" displayName="Xem bảng chấm công">
          <Scopes>
            <Scope value="Company" displayName="Toàn công ty" />
            <Scope value="Department" displayName="Cùng phòng ban" />
            <Scope value="Self" displayName="Chỉ bản thân" />
          </Scopes>
        </Action>

        <!-- Approve timesheets -->
        <Action name="Approve" displayName="Phê duyệt bảng chấm công">
          <Scopes>
            <Scope value="Company" displayName="Toàn công ty" />
            <Scope value="Department" displayName="Cùng phòng ban" />
          </Scopes>
          <Constraints>
            <Constraint type="WorkflowState">
              <Parameters>
                <Parameter name="AllowedStates" value="Submitted,Pending" />
              </Parameters>
            </Constraint>
          </Constraints>
        </Action>

        <!-- Export timesheets -->
        <Action name="Export" displayName="Xuất bảng chấm công">
          <Scopes>
            <Scope value="Company" displayName="Toàn công ty" />
            <Scope value="Department" displayName="Cùng phòng ban" />
          </Scopes>
        </Action>
      </Entity>

      <Entity name="LeaveRequest" displayName="Đơn xin nghỉ">
        <!-- View leave requests -->
        <Action name="View" displayName="Xem đơn nghỉ">
          <Scopes>
            <Scope value="Company" displayName="Toàn công ty" />
            <Scope value="Department" displayName="Cùng phòng ban" />
            <Scope value="Self" displayName="Chỉ bản thân" />
          </Scopes>
        </Action>

        <!-- Approve leave requests -->
        <Action name="Approve" displayName="Phê duyệt đơn nghỉ">
          <Scopes>
            <Scope value="Company" displayName="Toàn công ty" />
            <Scope value="Department" displayName="Cùng phòng ban" />
          </Scopes>
          <Constraints>
            <Constraint type="WorkflowState">
              <Parameters>
                <Parameter name="AllowedStates" value="Submitted,Pending" />
              </Parameters>
            </Constraint>
          </Constraints>
        </Action>

        <!-- Reject leave requests -->
        <Action name="Reject" displayName="Từ chối đơn nghỉ">
          <Scopes>
            <Scope value="Company" displayName="Toàn công ty" />
            <Scope value="Department" displayName="Cùng phòng ban" />
          </Scopes>
          <Constraints>
            <Constraint type="WorkflowState">
              <Parameters>
                <Parameter name="AllowedStates" value="Submitted,Pending" />
              </Parameters>
            </Constraint>
          </Constraints>
        </Action>
      </Entity>

    </Module>

    <!-- Payroll Module -->
    <Module name="Payroll" displayName="Bảng lương">

      <Entity name="Payroll" displayName="Bảng lương">
        <!-- View payroll -->
        <Action name="View" displayName="Xem bảng lương">
          <Scopes>
            <Scope value="Company" displayName="Toàn công ty" />
            <Scope value="Department" displayName="Cùng phòng ban" />
          </Scopes>
        </Action>

        <!-- Create payroll -->
        <Action name="Create" displayName="Tạo bảng lương">
          <Scopes>
            <Scope value="Company" displayName="Toàn công ty" />
            <Scope value="Department" displayName="Cùng phòng ban" />
          </Scopes>
        </Action>

        <!-- Process payroll -->
        <Action name="Process" displayName="Xử lý bảng lương">
          <Scopes>
            <Scope value="Company" displayName="Toàn công ty" />
            <Scope value="Department" displayName="Cùng phòng ban" />
          </Scopes>
          <Constraints>
            <Constraint type="WorkflowState">
              <Parameters>
                <Parameter name="AllowedStates" value="Draft,Pending" />
              </Parameters>
            </Constraint>
          </Constraints>
        </Action>

        <!-- Export payroll -->
        <Action name="Export" displayName="Xuất bảng lương">
          <Scopes>
            <Scope value="Company" displayName="Toàn công ty" />
            <Scope value="Department" displayName="Cùng phòng ban" />
          </Scopes>
        </Action>
      </Entity>

    </Module>

  </Permissions>
</PermissionTemplate>
