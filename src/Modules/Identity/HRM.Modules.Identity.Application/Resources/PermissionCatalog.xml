<?xml version="1.0" encoding="UTF-8"?>
<PermissionCatalog Module="Identity" Version="1.0" xmlns="http://hrm.system/permissions">
  <!--
    Identity Module Permission Catalog
    Defines all permissions for identity management (users, operators, roles)

    This file is embedded as a resource and loaded via IPermissionCatalogSourceFactory

    Scope Hierarchy (higher level = more access):
    - Global (4): System-wide access (super admin)
    - Company (3): Whole company access
    - Department (2): Same department only
    - Self (1): Only own data
  -->

  <!-- Scope Definitions (reusable) -->
  <ScopeDefinitions>
    <Scope Name="Global" Level="4" DisplayName="Toàn hệ thống" />
    <Scope Name="Company" Level="3" DisplayName="Toàn công ty" />
    <Scope Name="Department" Level="2" DisplayName="Cùng phòng ban" />
    <Scope Name="Self" Level="1" DisplayName="Chỉ bản thân" />
  </ScopeDefinitions>

  <Permissions>

    <!-- User Entity - External users (future module) -->
    <Permission Key="Identity.User.View" DisplayName="Xem người dùng" DefaultScope="Department">
      <AllowedScopes>
        <Scope Name="Company" />
        <Scope Name="Department" />
        <Scope Name="Self" />
      </AllowedScopes>
    </Permission>

    <Permission Key="Identity.User.Create" DisplayName="Tạo người dùng" DefaultScope="Department">
      <AllowedScopes>
        <Scope Name="Company" />
        <Scope Name="Department" />
      </AllowedScopes>
    </Permission>

    <Permission Key="Identity.User.Update" DisplayName="Cập nhật người dùng" DefaultScope="Department">
      <AllowedScopes>
        <Scope Name="Company" />
        <Scope Name="Department" />
        <Scope Name="Self" />
      </AllowedScopes>
    </Permission>

    <Permission Key="Identity.User.Delete" DisplayName="Xóa người dùng" DefaultScope="Department">
      <AllowedScopes>
        <Scope Name="Company" />
        <Scope Name="Department" />
      </AllowedScopes>
    </Permission>

    <Permission Key="Identity.User.ResetPassword" DisplayName="Đặt lại mật khẩu" DefaultScope="Self">
      <AllowedScopes>
        <Scope Name="Company" />
        <Scope Name="Department" />
        <Scope Name="Self" />
      </AllowedScopes>
    </Permission>

    <Permission Key="Identity.User.AssignRole" DisplayName="Gán vai trò cho người dùng" DefaultScope="Department">
      <AllowedScopes>
        <Scope Name="Company" />
        <Scope Name="Department" />
      </AllowedScopes>
    </Permission>

    <!-- Operator Entity - Internal system administrators -->
    <!-- Operators are system-level, no department/self scope needed -->
    <Permission Key="Identity.Operator.View" DisplayName="Xem quản trị viên" DefaultScope="Global">
      <AllowedScopes>
        <Scope Name="Global" />
      </AllowedScopes>
    </Permission>

    <Permission Key="Identity.Operator.Create" DisplayName="Tạo quản trị viên" DefaultScope="Global">
      <AllowedScopes>
        <Scope Name="Global" />
      </AllowedScopes>
    </Permission>

    <Permission Key="Identity.Operator.Update" DisplayName="Cập nhật quản trị viên" DefaultScope="Global">
      <AllowedScopes>
        <Scope Name="Global" />
      </AllowedScopes>
    </Permission>

    <Permission Key="Identity.Operator.Delete" DisplayName="Xóa quản trị viên" DefaultScope="Global">
      <AllowedScopes>
        <Scope Name="Global" />
      </AllowedScopes>
    </Permission>

    <Permission Key="Identity.Operator.ResetPassword" DisplayName="Đặt lại mật khẩu quản trị viên" DefaultScope="Global">
      <AllowedScopes>
        <Scope Name="Global" />
      </AllowedScopes>
    </Permission>

    <Permission Key="Identity.Operator.AssignRole" DisplayName="Gán vai trò cho quản trị viên" DefaultScope="Global">
      <AllowedScopes>
        <Scope Name="Global" />
      </AllowedScopes>
    </Permission>

    <!-- Role Entity -->
    <Permission Key="Identity.Role.View" DisplayName="Xem vai trò" DefaultScope="Global">
      <AllowedScopes>
        <Scope Name="Global" />
      </AllowedScopes>
    </Permission>

    <Permission Key="Identity.Role.Create" DisplayName="Tạo vai trò" DefaultScope="Global">
      <AllowedScopes>
        <Scope Name="Global" />
      </AllowedScopes>
    </Permission>

    <Permission Key="Identity.Role.Update" DisplayName="Cập nhật vai trò" DefaultScope="Global">
      <AllowedScopes>
        <Scope Name="Global" />
      </AllowedScopes>
    </Permission>

    <Permission Key="Identity.Role.Delete" DisplayName="Xóa vai trò" DefaultScope="Global">
      <AllowedScopes>
        <Scope Name="Global" />
      </AllowedScopes>
    </Permission>

    <Permission Key="Identity.Role.AssignPermission" DisplayName="Gán quyền cho vai trò" DefaultScope="Global">
      <AllowedScopes>
        <Scope Name="Global" />
      </AllowedScopes>
    </Permission>

  </Permissions>

</PermissionCatalog>
